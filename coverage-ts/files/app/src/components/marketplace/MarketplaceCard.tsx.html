
  <!DOCTYPE html>
  <html>
    <head>
      <title>MarketplaceCard.tsx</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">app/src/components/marketplace/MarketplaceCard.tsx</td><td class="">94.66%</td><td class="">80%</td><td class="">281</td><td class="">266</td><td class="">15</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import {
  Avatar,
  Card,
  CardActions,
  CardContent,
  CardHeader,
  CardMedia,
  Collapse,
  IconButton,
  Menu,
  MenuItem,
  Typography,
  styled
} from &#x27;@mui/material&#x27;;
import MuiAlert, { AlertProps } from &#x27;@mui/material/Alert&#x27;;
import React, { useEffect } from &#x27;react&#x27;;
import {
  openProject,
  resetAllState
} from &#x27;../../redux/reducers/slice/appStateSlice&#x27;;
import { useDispatch, useSelector } from &#x27;react-redux&#x27;;
import { MoreVert } from &#x27;@mui/icons-material&#x27;;
import { RootState } from &#x27;../../redux/store&#x27;;
import Snackbar from &#x27;@mui/material/Snackbar&#x27;;
import axios from &#x27;axios&#x27;;
// import imageSrc from &#x27;../../../../resources/marketplace_images/marketplace_image.png&#x27;;
import { red } from &#x27;@mui/material/colors&#x27;;
import { saveProject } from &#x27;../../helperFunctions/projectGetSaveDel&#x27;;
import { useHistory } from &#x27;react-router-dom&#x27;;
import { Amplify, Storage } from &#x27;aws-amplify&#x27;;
import awsconfig from &#x27;../../../../src/custom-aws-exports&#x27;;

interface Project {
  forked: String;
  comments: string[];
  createdAt: Date;
  likes: number;
  name: string;
  project: object;
  published: boolean;
  userId: number;
  username: string;
  _id: number;
}

const ITEM_HEIGHT = 48;
const MarketplaceCard = ({ proj }: { proj: Project }) =&gt; {
  const dispatch = useDispatch();
  const history = useHistory();
  const [anchorEl, setAnchorEl] = React.useState&lt;null | HTMLElement&gt;(null);
  const [s3ImgURL, setS3ImgURL] = React.useState&lt;null | string&gt;(null);
  const open = Boolean(anchorEl);
  const [alertOpen, setAlertOpen] = React.useState&lt;boolean&gt;(false);
  const [guest, setGuest] = React.useState&lt;boolean&gt;(null);
  const state = useSelector((store: RootState) =&gt; store.appState);


  useEffect(() =&gt; {
    async function s3ImgFetch() {
      Amplify.configure(awsconfig);
      try {
        const objId: string = proj._id.toString();
        // the below functions are commented out as not to incur too many charges
        const response: string = await Storage.get(objId);
        // const response: string = await Storage.get(&#x27;test&#x27;);
        setS3ImgURL(response);
      } catch (error) {
        console.error(`Error fetching image preview for ${proj._id}: `, error);
      }
    }
    s3ImgFetch();
  }, []);



  const handleClick = (event: React.MouseEvent&lt;HTMLElement&gt;) =&gt; {
    setAnchorEl(event.currentTarget);
  };
  const handleClone = async () =&gt; {
    if(state.isLoggedIn){
      // creates a copy of the project
      const docId = proj._id;
      const response = await axios.get(`/cloneProject/${docId}`); //passing in username as a query param is query params
      const project = response.data;
      setAlertOpen(true);
      setAnchorEl(null);
      return {
        _id: project._id,
        name: project.name,
        published: project.published,
        ...project.project
      };
    }
    setGuest(true);
  };

  const handleCloneOpen = async () =&gt; {
    if(state.isLoggedIn){
      const project = await handleClone();
      history.push(&#x27;/&#x27;);
      dispatch(openProject(project));
    }
  };

  const handleClose = () =&gt; {
    setAnchorEl(null);
  };

  const handleAlertClose = (
    event: React.SyntheticEvent | Event,
    reason?: string
  ) =&gt; {
    if (reason === &#x27;clickaway&#x27;) {
      return;
    }
    setAlertOpen(false);
    setAnchorEl(null);
  };

  const Alert = React.forwardRef&lt;HTMLDivElement, AlertProps&gt;(function Alert(
    props,
    ref
  ) {
    return &lt;MuiAlert elevation={6} ref={ref} variant=&quot;filled&quot; {...props} /&gt;;
  });

  return (
    &lt;&gt;
      &lt;Card
        sx={{ maxWidth: 384, backgroundColor: &#x27;#1E1E1E&#x27;, borderRadius: &#x27;12px&#x27; }}
      &gt;
        &lt;CardMedia
          sx={{ borderRadius: &#x27;12px&#x27;, height: 200 }}
          component=&quot;img&quot;
          height=&quot;194&quot;
          image={s3ImgURL}
          alt=&quot;component preview&quot;
        /&gt;
        &lt;CardHeader
          avatar={
            &lt;Avatar sx={{ bgcolor: &#x27;#0bcaa8&#x27; }} aria-label=&quot;recipe&quot;&gt;
              {proj.username.slice(0,1).toUpperCase()}
            &lt;/Avatar&gt;
          }
          action={
            &lt;IconButton
              aria-label=&quot;more&quot;
              id=&quot;long-button&quot;
              aria-controls={open ? &#x27;long-menu&#x27; : undefined}
              aria-expanded={open ? &#x27;true&#x27; : undefined}
              aria-haspopup=&quot;true&quot;
              onClick={handleClick}
            &gt;
              &lt;MoreVert /&gt;
            &lt;/IconButton&gt;
          }
          title={proj.name}
          subheader={proj.username}
        /&gt;
        &lt;Menu
          id=&quot;long-menu&quot;
          MenuListProps={{
            &#x27;aria-labelledby&#x27;: &#x27;long-button&#x27;
          }}
          anchorEl={anchorEl}
          open={open}
          onClose={handleClose}
          PaperProps={{
            style: {
              maxHeight: ITEM_HEIGHT * 4.5,
              width: &#x27;20ch&#x27;,
              backgroundColor: &#x27;#1E1E1E&#x27;
            }
          }}
        &gt;
          &lt;MenuItem
            onClick={handleClone}
            sx={{
              color: &#x27;#fff&#x27;
            }}
          &gt;
            Clone
          &lt;/MenuItem&gt;
          &lt;MenuItem
            onClick={handleCloneOpen}
            sx={{
              color: &#x27;#fff&#x27;
            }}
          &gt;
            Clone and open
          &lt;/MenuItem&gt;
        &lt;/Menu&gt;
        &lt;Snackbar
          open={alertOpen}
          autoHideDuration={3000}
          anchorOrigin={{ vertical: &#x27;top&#x27;, horizontal: &#x27;center&#x27; }} 
          onClose={handleAlertClose}
        &gt;
          &lt;Alert
            onClose={handleAlertClose}
            severity=&quot;success&quot;
            sx={{ width: &#x27;100%&#x27;, color: &#x27;white&#x27; }}
          &gt;
            Project Cloned!
          &lt;/Alert&gt;
        &lt;/Snackbar&gt;
        &lt;Snackbar
          open={guest}
          autoHideDuration={3000}
          anchorOrigin={{ vertical: &#x27;top&#x27;, horizontal: &#x27;center&#x27; }} 
          onClose={handleAlertClose}
        &gt;
          &lt;Alert
            onClose={handleAlertClose}
            severity=&quot;error&quot;
            sx={{ width: &#x27;100%&#x27;, color: &#x27;white&#x27; }}
          &gt;
            Please login to clone!
          &lt;/Alert&gt;
        &lt;/Snackbar&gt;
      &lt;/Card&gt;
    &lt;/&gt;
  );
};

export default MarketplaceCard;
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:83,&quot;character&quot;:12,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:83,&quot;character&quot;:31,&quot;text&quot;:&quot;data&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:87,&quot;character&quot;:8,&quot;text&quot;:&quot;_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:87,&quot;character&quot;:13,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:87,&quot;character&quot;:21,&quot;text&quot;:&quot;_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:88,&quot;character&quot;:8,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:88,&quot;character&quot;:14,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:88,&quot;character&quot;:22,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:89,&quot;character&quot;:8,&quot;text&quot;:&quot;published&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:89,&quot;character&quot;:19,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:89,&quot;character&quot;:27,&quot;text&quot;:&quot;published&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:90,&quot;character&quot;:11,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:90,&quot;character&quot;:19,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:98,&quot;character&quot;:12,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;app/src/components/marketplace/MarketplaceCard.tsx&quot;,&quot;line&quot;:100,&quot;character&quot;:27,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Sat, 28 Oct 2023 14:16:19 GMT</p>
    </body>
  </html>
  